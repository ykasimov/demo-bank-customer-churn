schema: '2.0'
stages:
  data_split:
    cmd: python stages/data_split.py --config=params.yaml
    deps:
    - path: data/Churn_Modelling_0.csv
      md5: 201b3eb1d8d81aa6286466385528b3e2
      size: 342639
    - path: stages/data_split.py
      md5: 519fbe22a8ce712999f28010f3c56fe6
      size: 1606
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling_0.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: model/
        data_split:
          test_size: 0.25
    outs:
    - path: data/X_test.pkl
      md5: fd3007d1a7bdff44ff89571ebedd519e
      size: 93528
    - path: data/X_train.pkl
      md5: 56146d7dde8707b66619ce99e7cfcc20
      size: 278467
    - path: data/y_test.pkl
      md5: 745eb9da6d360516befe492af2787d41
      size: 30613
    - path: data/y_train.pkl
      md5: dbb125a59205f428a0b3e535efdfe83d
      size: 90598
  train:
    cmd: python stages/train.py --config=params.yaml
    deps:
    - path: data/X_train.pkl
      md5: 56146d7dde8707b66619ce99e7cfcc20
      size: 278467
    - path: data/y_train.pkl
      md5: dbb125a59205f428a0b3e535efdfe83d
      size: 90598
    - path: stages/train.py
      md5: 5f07d5209c52f77d2e474d539c59987f
      size: 3076
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling_0.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: model/
        train:
          model_type: randomforest
          update_model: anavo-model
          params:
            n_estimators: 55
            max_depth: 5
            warm_start: true
    outs:
    - path: model//clf-model
      md5: c1ee80ed9469f6c286173580e3c999ff
      size: 222423
    - path: model//clf-model.mlem
      md5: a64ec4cfe5c2655f9b65f9df247d263b
      size: 1706
  compare:
    cmd: python stages/compare.py --config=params.yaml
    deps:
    - path: data/X_test.pkl
      md5: fd3007d1a7bdff44ff89571ebedd519e
      size: 93528
    - path: data/y_test.pkl
      md5: 745eb9da6d360516befe492af2787d41
      size: 30613
    - path: model/clf-model
      md5: c1ee80ed9469f6c286173580e3c999ff
      size: 222423
    - path: stages/compare.py
      md5: 161e370a109d29d468dd0c15b75b23f5
      size: 1651
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling_0.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: model/
    outs:
    - path: comparison_metrics.json
      md5: 7f068baaf359d91a873052b2412e8cdf
      size: 95
  eval:
    cmd: python stages/eval.py --config=params.yaml
    deps:
    - path: data/X_test.pkl
      md5: fd3007d1a7bdff44ff89571ebedd519e
      size: 93528
    - path: data/y_test.pkl
      md5: 745eb9da6d360516befe492af2787d41
      size: 30613
    - path: model//clf-model
      md5: c1ee80ed9469f6c286173580e3c999ff
      size: 222423
    - path: model//clf-model.mlem
      md5: a64ec4cfe5c2655f9b65f9df247d263b
      size: 1706
    - path: stages/eval.py
      md5: 0f8bd41fc66ef9117d6e3451a3ed3631
      size: 2700
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling_0.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: model/
        data_split:
          test_size: 0.25
        train:
          model_type: randomforest
          update_model: anavo-model
          params:
            n_estimators: 55
            max_depth: 5
            warm_start: true
    outs:
    - path: eval_plots/cm.png
      md5: 356c92e510ba172be5015a2642fe11f4
      size: 10534
    - path: eval_plots/plots/sklearn/roc.json
      md5: 13a45d25cd0c65ec4c798c7190b90bfd
      size: 41712
    - path: feat_imp.csv
      md5: 65b806f5d3ecc1f2ae31279b08148b2c
      size: 304
    - path: metrics.json
      md5: 3f347ce00a234b93063bc4d91a7ab91d
      size: 67
    - path: models/perm_imp.joblib
      md5: c46f70817df0012bcb43bd945f13ccce
      size: 223755
